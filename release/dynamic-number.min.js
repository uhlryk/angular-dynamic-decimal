(function(x,w){if("function"===typeof define&&define.amd)define(["angular"],w);else if("undefined"!==typeof module&&"object"===typeof module.exports)module.exports=w(require("angular"));else return w(x.angular)})(window,function(x){function w(a,b,e,h){return void 0===a||null===a||""===a?0:","===b?String(a).replace(".",","):String(a)}function D(a,b,e){e&&(a+=e);b&&(/^\-.+/.test(a)?a=a.replace("-","-"+b):/^\-/.test(a)||(a=b+a));return a}function E(a,b){return 0<=a&&(a=parseInt(a,10),!1===isNaN(a)&&
isFinite(a)&&0<=a)?a:b}function F(a,b){return","===a?",":"."===a?".":b}function G(a,b){return"floor"===a?Math.floor:"ceil"===a?Math.ceil:"round"===a?Math.round:b}function H(a,b){return"false"===a||!1===a?!1:"true"===a||!0===a?!0:b}function I(a,b){return"false"===a||!1===a?!1:"true"===a||!0===a?!0:b}function J(a,b,e){return a?("."===b?/^[',\s]$/:/^['\.\s]$/).test(a)?a:e:e}function y(a){return/[^\d,\.\s\-]{1}/.test(a)?a:null}function K(a){return String(a).replace(/^0+/g,"").replace(/^-0(\d+)/g,"-$1").replace(/^-([\.,\s])/g,
"-0$1").replace(/^[\.,\s]/g,"0$\x26")}function L(a,b){return"."===b?String(a).replace(/\./g,""):","===b?String(a).replace(/,/g,""):String(a).replace(/['\s]/g,"")}function z(a,b,e){a=String(a).split(b);a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,e);return a.join(b)}function v(a,b,e,h,c){c&&(h.enable=!1);b=String(b);if(e.isFixed)for(h=(h=b.split(e.fractionSeparator)[1])&&h.length?h.length:0,0===h&&(b+=e.fractionSeparator);h<e.fractionPart;h++)b+="0";e=D(b,e.prepend,e.append);b=x.version;1===b.major&&
2===b.minor?a.$viewValue=e:a.$setViewValue(e);a.$render()}function A(a,b,e,h,c,d,l,f,g,t){if(""===a||void 0===a||null===a)return t;a=Number(a);return!isNaN(a)&&isFinite(a)?(t=Math.pow(10,b),a=c?w((h(a*t)/t).toFixed(b),e,f,g):w(String(h(a*t)/t),e,f,g),a=D(a,f,g),d&&(a=z(a,e,l)),a):c?(0).toFixed(b):"0"}function B(a,b){null!==a&&(a.createTextRange?(a=a.createTextRange(),a.move("character",b),a.select()):a.selectionStart?(a.focus(),a.setSelectionRange(b,b)):a.focus())}function m(a,b,e){a={awnum:a.awnum,
numInt:a.numInt,numFract:a.numFract,numSep:a.numSep,numPos:a.numPos,numNeg:a.numNeg,numRound:a.numRound,numThousand:a.numThousand,numThousandSep:a.numThousandSep,numPrepend:a.numPrepend,numAppend:a.numAppend,numFixed:a.numFixed,numBlank:a.numBlank};b&&(a[b]=e);return a}function n(a,b,e,h,c){var d={};a.awnum&&(d=c.getStrategy(a.awnum));a:{c=void 0!==a.numInt?a.numInt:d.numInt;if(0<=c&&(c=parseInt(c,10),!1===isNaN(c)&&isFinite(c)&&0<=c))break a;c=6}var l=E(void 0!==a.numFract?a.numFract:d.numFract,
2),f=F(void 0!==a.numSep?a.numSep:d.numSep,"."),g;g=void 0!==a.numPos?a.numPos:d.numPos;g="false"===g||!1===g?!1:!0;var t;t=void 0!==a.numNeg?a.numNeg:d.numNeg;t="false"===t||!1===t?!1:!0;var m=G(void 0!==a.numRound?a.numRound:d.numRound,Math.round),M=I(void 0!==a.numThousand?a.numThousand:d.numThousand,!1),p=J(void 0!==a.numThousandSep?a.numThousandSep:d.numThousandSep,f,"."===f?",":"."),u=y(void 0!==a.numPrepend?a.numPrepend:d.numPrepend),k=y(void 0!==a.numAppend?a.numAppend:d.numAppend),q=void 0!==
a.numBlank?a.numBlank:d.numBlank;a=H(void 0!==a.numFixed?a.numFixed:d.numFixed,!1);if(!1===g&&!1===t)throw Error("Number is set to not be positive and not be negative. Change num_pos attr or/and num_neg attr to true");d="-?";!1===g&&!0===t?d="-":!0===g&&!1===t&&(d="");var n="[0-9]{0,"+c+"}";0===c&&(n="0");var r="(\\"+f+"([0-9]){0,"+l+"})";0===l&&(r="");return{element:b,attrs:e,ngModelController:h,viewRegexTest:new RegExp("^"+d+n+r+"?$"),integerPart:c,fractionPart:l,fractionSeparator:f,isPositiveNumber:g,
isNegativeNumber:t,roundFunction:m,isThousandSeparator:M,thousandSeparator:p,prepend:u,append:k,isFixed:a,blank:q}}function N(a,b,e){var h=b.element,c=b.ngModelController,d=b.viewRegexTest,l=b.fractionPart,f=b.fractionSeparator,g=b.isPositiveNumber,t=b.isNegativeNumber,n=b.isThousandSeparator,m=b.thousandSeparator,p=b.prepend,u=b.append,k=String(a);if(C){C=!1;var q=new RegExp("[^"+(t?"-":"")+f+m+"0-9]+","g"),k=k.replace(q,""),q=new RegExp("^["+f+m+"]"),k=k.replace(q,""),q=new RegExp("["+f+m+"]([0-9]{"+
l+"})$"),k=k.replace(q,f+"$1")}p&&(k=k.replace(new RegExp("[\\"+p+"]","g"),""));u&&(k=k.replace(new RegExp("[\\"+u+"]","g"),""));k=k.replace(new RegExp("[\\"+b.fractionSeparator+"]+","g"),b.fractionSeparator);if((new RegExp("^[.,"+m+"]{2,}")).test(k))return v(c,0,b,e),0;u=h[0];q=0;if(document.selection)u.focus(),q=document.selection.createRange(),q.moveStart("character",-u.value.length),q=q.text.length;else if(u.selectionStart||"0"==u.selectionStart)q="backward"==u.selectionDirection?u.selectionStart:
u.selectionEnd;u=q;p&&u--;var q=k.slice(0,u),q=L(q,m),k=L(k,m),q=K(q),r=k,k=K(k);if(k==="0"+f&&r===f&&g)return l?(v(c,"0"+f,b,e,!0),B(h[0],2)):v(c,"",b,e),0;if(""===k&&"0"===String(a).charAt(0))return v(c,0,b),0;if(void 0===k||""===k)return 0;if("-"===k)return g&&!t?v(c,"",b,e):v(c,"-",b,e),0;l=k.split(b.fractionSeparator);a=l[0];(l=l[1])&&l.length>b.fractionPart&&(l=l.slice(0,b.fractionPart),k=[a,l].join(b.fractionSeparator));if(!1===d.test(k))return p=w(c.$modelValue,f,b),n&&(p=z(p,f,m)),v(c,p,
b,e),B(h[0],u-1),c.$modelValue;a=0;d=q.length;if(n)for(k=z(k,f,m),l=a=n=0;l<k.length;l++)if(k[l]!==m){if(n++,n>=d)break}else a++;p&&(a++,/^(\-\d)$/.test(k)&&(a+=2),/^(\d)$/.test(k)&&a++);v(c,k,b,e);B(h[0],d+a);b=k;f=","===f?String(b).replace(/['\.\s]/g,"").replace(",","."):"."===f?String(b).replace(/[',\s]/g,""):void 0;return f}function r(a,b){b=A(a.$modelValue,b.fractionPart,b.fractionSeparator,b.roundFunction,b.isFixed,b.isThousandSeparator,b.thousandSeparator,b.prepend,b.append,b.blank);a.$setViewValue("");
a.$render();a.$setViewValue(b);a.$render()}var C=!1;x.module("dynamicNumber",[]).constant("DEFAULT_BLANK","0").provider("dynamicNumberStrategy",function(){var a={};this.addStrategy=function(b,e){a[b]=e};this.getStrategy=function(b){return a[b]};this.$get=function(){return{getStrategy:function(b){return a[b]}}}}).filter("awnum",["dynamicNumberStrategy","DEFAULT_BLANK",function(a,b){return function(e,h,c,d,l,f,g,m,n,r){var p={};x.isString(h)&&(p=a.getStrategy(h),h=p.numFract);h=E(h,2);c=F(void 0!==
c?c:p.numSep,".");d=G(void 0!==d?d:p.numRound,Math.round);l=H(void 0!==l?l:p.numFixed,!1);f=I(void 0!==f?f:p.numThousand,!1);g=J(void 0!==g?g:p.numThousandSep,c,"."===c?",":".");m=y(void 0!==m?m:p.numPrepend);n=y(void 0!==n?n:p.numAppend);e=A(e,h,c,d,l,f,g,m,n,void 0!==r?r:p.numBlank);return void 0===e||null===e||""===e?b:e}}]).directive("awnum",["dynamicNumberStrategy",function(a){return{restrict:"A",require:"?ngModel",scope:{awnum:"@",numInt:"@",numFract:"@",numSep:"@",numPos:"@",numNeg:"@",numRound:"@",
numThousand:"@",numThousandSep:"@",numPrepend:"@",numAppend:"@",numFixed:"@",numBlank:"@"},link:function(b,e,h,c){if(!e[0]||"INPUT"!==e[0].tagName||"text"!==e[0].type&&"tel"!==e[0].type)console.warn("Directive angular-dynamic-number works only for 'input' tag with type \x3d 'text' or type \x3d 'tel'");else if(c){var d=n(m(b),e,h,c,a);e.on("paste",function(){C=!0});b.$watch("numInt",function(f,g){g!==f&&(d=n(m(b,"numInt",f),e,h,c,a),r(c,d))});b.$watch("numFract",function(f,g){g!==f&&(d=n(m(b,"numFract",
f),e,h,c,a),r(c,d))});b.$watch("numSep",function(f,g){g!==f&&(d=n(m(b,"numSep",f),e,h,c,a),r(c,d))});b.$watch("numPos",function(f,g){g!==f&&(d=n(m(b,"numPos",f),e,h,c,a),r(c,d))});b.$watch("numNeg",function(f,g){g!==f&&(d=n(m(b,"numNeg",f),e,h,c,a),r(c,d))});b.$watch("numThousand",function(f,g){g!==f&&(d=n(m(b,"numThousand",f),e,h,c,a),r(c,d))});b.$watch("numThousandSep",function(f,g){g!==f&&(d=n(m(b,"numThousandSep",f),e,h,c,a),r(c,d))});b.$watch("numAppend",function(f,g){g!==f&&(d=n(m(b,"numAppend",
f),e,h,c,a),r(c,d))});b.$watch("numPrepend",function(f,g){g!==f&&(d=n(m(b,"numPrepend",f),e,h,c,a),r(c,d))});b.$watch("numFixed",function(f,g){g!==f&&(d=n(m(b,"numFixed",f),e,h,c,a),r(c,d))});b.$watch("numBlank",function(f,g){g!==f&&(d=n(m(b,"numBlank",f),e,h,c,a),r(c,d))});var l={enable:!0,count:0};c.$parsers.unshift(function(a){if(l.enable)return l.count++,Number(N(a,d,l));l.enable=!0;return a});c.$formatters.push(function(a){return A(a,d.fractionPart,d.fractionSeparator,d.roundFunction,d.isFixed,
d.isThousandSeparator,d.thousandSeparator,d.prepend,d.append,d.blank)})}else console.warn("Directive angular-dynamic-number need ngModel attribute")}}}]);return"dynamicNumber"});